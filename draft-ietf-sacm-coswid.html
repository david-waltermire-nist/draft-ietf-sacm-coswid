<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Concise Software Identifiers</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract p {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre {
  font: 15px Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 The SWID Tag Lifecycle">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Concise SWID Extensions">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Requirements Notation">
<link href="#rfc.section.2" rel="Chapter" title="2 Concise SWID Data Definition">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 The concise-software-identity Object">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Determining the tag type">
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 concise-software-identity Co-constraints">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 The global-attributes Group">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 The any-element-map Entry">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 The entity Object">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 The link Object">
<link href="#rfc.section.2.6" rel="Chapter" title="2.6 The software-meta Object">
<link href="#rfc.section.2.7" rel="Chapter" title="2.7 The Resource Collection Definition">
<link href="#rfc.section.2.7.1" rel="Chapter" title="2.7.1 The hash-entry Array">
<link href="#rfc.section.2.7.2" rel="Chapter" title="2.7.2 The resource-collection Group">
<link href="#rfc.section.2.7.3" rel="Chapter" title="2.7.3 The payload Object">
<link href="#rfc.section.2.7.4" rel="Chapter" title="2.7.4 The evidence Object">
<link href="#rfc.section.2.8" rel="Chapter" title="2.8 Full CDDL Definition">
<link href="#rfc.section.3" rel="Chapter" title="3 CoSWID Indexed Label Values">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Version Scheme">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Entity Role Values">
<link href="#rfc.section.4" rel="Chapter" title="4 IANA Considerations">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 SWID/CoSWID Version Schema Values Registry">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 SWID/CoSWID Entity Role Values Registry">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Media Type Registration">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 swid+cbor Media Type Registration">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 CoAP Content-Format Registration">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 CBOR Tag Registration">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Acknowledgments">
<link href="#rfc.section.7" rel="Chapter" title="7 Change Log">
<link href="#rfc.section.8" rel="Chapter" title="8 Contributors">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A CoSWID Attributes for Firmware (label 60)">
<link href="#rfc.appendix.B" rel="Chapter" title="B Signed Concise SWID Tags using COSE">
<link href="#rfc.appendix.C" rel="Chapter" title="C CoSWID used as Reference Integrity Measurements (CoSWID RIM)">
<link href="#rfc.appendix.D" rel="Chapter" title="D CBOR Web Token for Concise SWID Tags">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.11.1 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Birkholz, H., Fitzgerald-McKay, J., Schmidt, C., and D. Waltermire" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-sacm-coswid-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2018-10-22" />
  <meta name="dct.abstract" content="This document defines a concise representation of ISO/IEC 19770-2:2015 Software Identification (SWID) tags that are interoperable with the XML schema definition of ISO/IEC 19770-2:2015 and augmented for application in Constrained-Node Networks. Next to the inherent capability of SWID tags to express arbitrary context information, Concise SWID (CoSWID) tags support the definition of additional semantics via well-defined data definitions incorporated by extension points." />
  <meta name="description" content="This document defines a concise representation of ISO/IEC 19770-2:2015 Software Identification (SWID) tags that are interoperable with the XML schema definition of ISO/IEC 19770-2:2015 and augmented for application in Constrained-Node Networks. Next to the inherent capability of SWID tags to express arbitrary context information, Concise SWID (CoSWID) tags support the definition of additional semantics via well-defined data definitions incorporated by extension points." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">SACM Working Group</td>
<td class="right">H. Birkholz</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Fraunhofer SIT</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">J. Fitzgerald-McKay</td>
</tr>
<tr>
<td class="left">Expires: April 25, 2019</td>
<td class="right">Department of Defense</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">C. Schmidt</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">The MITRE Corporation</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. Waltermire</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">NIST</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 22, 2018</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Concise Software Identifiers<br />
  <span class="filename">draft-ietf-sacm-coswid-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines a concise representation of ISO/IEC 19770-2:2015 Software Identification (SWID) tags that are interoperable with the XML schema definition of ISO/IEC 19770-2:2015 and augmented for application in Constrained-Node Networks. Next to the inherent capability of SWID tags to express arbitrary context information, Concise SWID (CoSWID) tags support the definition of additional semantics via well-defined data definitions incorporated by extension points.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 25, 2019.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2018 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">The SWID Tag Lifecycle</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Concise SWID Extensions</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Requirements Notation</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Concise SWID Data Definition</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">The concise-software-identity Object</a>
</li>
<ul><li>2.1.1.   <a href="#rfc.section.2.1.1">Determining the tag type</a>
</li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">concise-software-identity Co-constraints</a>
</li>
</ul><li>2.2.   <a href="#rfc.section.2.2">The global-attributes Group</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">The any-element-map Entry</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">The entity Object</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">The link Object</a>
</li>
<li>2.6.   <a href="#rfc.section.2.6">The software-meta Object</a>
</li>
<li>2.7.   <a href="#rfc.section.2.7">The Resource Collection Definition</a>
</li>
<ul><li>2.7.1.   <a href="#rfc.section.2.7.1">The hash-entry Array</a>
</li>
<li>2.7.2.   <a href="#rfc.section.2.7.2">The resource-collection Group</a>
</li>
<li>2.7.3.   <a href="#rfc.section.2.7.3">The payload Object</a>
</li>
<li>2.7.4.   <a href="#rfc.section.2.7.4">The evidence Object</a>
</li>
</ul><li>2.8.   <a href="#rfc.section.2.8">Full CDDL Definition</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">CoSWID Indexed Label Values</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Version Scheme</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Entity Role Values</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">IANA Considerations</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">SWID/CoSWID Version Schema Values Registry</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">SWID/CoSWID Entity Role Values Registry</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Media Type Registration</a>
</li>
<ul><li>4.3.1.   <a href="#rfc.section.4.3.1">swid+cbor Media Type Registration</a>
</li>
</ul><li>4.4.   <a href="#rfc.section.4.4">CoAP Content-Format Registration</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">CBOR Tag Registration</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Acknowledgments</a>
</li>
<li>7.   <a href="#rfc.section.7">Change Log</a>
</li>
<li>8.   <a href="#rfc.section.8">Contributors</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<ul><li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">CoSWID Attributes for Firmware (label 60)</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Signed Concise SWID Tags using COSE</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.C">CoSWID used as Reference Integrity Measurements (CoSWID RIM)</a>
</li>
<li>Appendix D.   <a href="#rfc.appendix.D">CBOR Web Token for Concise SWID Tags</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">SWID tags have several use-applications including but not limited to:</p>
<p></p>

<ul>
<li>Software Inventory Management, a part of the Software Asset Management <a href="#SAM" class="xref">[SAM]</a> process, which requires an accurate list of discernible deployed software components.</li>
<li>Vulnerability Assessment, which requires a semantic link between standardized vulnerability descriptions and software components installed on IT-assets <a href="#X.1520" class="xref">[X.1520]</a>.</li>
<li>Remote Attestation, which requires a link between reference integrity measurements (RIM) and security logs of measured software components <a href="#I-D.birkholz-tuda" class="xref">[I-D.birkholz-tuda]</a>.</li>
</ul>
<p id="rfc.section.1.p.3">SWID tags, as defined in ISO-19770-2:2015 <a href="#SWID" class="xref">[SWID]</a>, provide a standardized XML-based record format that identifies and describes a specific release of a software component. Different software components, and even different releases of a particular software component, each have a different SWID tag record associated with them. SWID tags are meant to be flexible and able to express a broad set of metadata about a software component.</p>
<p id="rfc.section.1.p.4">While there are very few required fields in SWID tags, there are many optional fields that support different use scenarios. While a SWID tag consisting of only required fields might be a few hundred bytes in size, a tag containing many of the optional fields can be many orders of magnitude larger. Thus, real-world instances of SWID tags can be fairly large, and the communication of SWID tags in use-applications such as those described earlier can cause a large amount of data to be transported. This can be larger than acceptable for constrained devices and networks. Concise SWID (CoSWID) tags significantly reduce the amount of data transported as compared to a typical SWID tag. This reduction is enabled through the use of CBOR, which maps human-readable labels of that content to more concise integer labels (indices). The use of CBOR to express SWID information in CoSWID tags allows both CoSWID and SWID tags to be part of an enterprise security solution for a wider range of endpoints and environments.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#intro-lifecycle" id="intro-lifecycle">The SWID Tag Lifecycle</a>
</h1>
<p id="rfc.section.1.1.p.1">In addition to defining the format of a SWID tag record, ISO/IEC 19770-2:2015 defines requirements concerning the SWID tag lifecycle. Specifically, when a software component is installed on an endpoint, that product&#8217;s SWID tag is also installed. Likewise, when the product is uninstalled or replaced, the SWID tag is deleted or replaced, as appropriate. As a result, ISO/IEC 19770-2:2015 describes a system wherein there is a correspondence between the set of installed software components on an endpoint, and the presence of the correspondingsponding SWID tags for these components on that endpoint. CoSWIDs share the same lifecycle requirements as a SWID tag.</p>
<p id="rfc.section.1.1.p.2">The following is an excerpt (with some modifications and reordering) from NIST Interagency Report (NISTIR) 8060: Guidelines for the Creation of Interoperable SWID Tags <a href="#SWID-GUIDANCE" class="xref">[SWID-GUIDANCE]</a>, which describes the tag types used within the lifecycle defined in ISO-19770-2:2015.</p>
<p></p>

<ul class="empty"><li>The SWID specification defines four types of SWID tags: primary, patch, corpus, and supplemental.</li></ul>
<p></p>

<ol>
<li>Primary Tag - A SWID or CoSWID tag that identifies and describes a software component is installed on a computing device.</li>
<li>Patch Tag - A SWID or CoSWID tag that identifies and describes an installed patch which has made incremental changes to a software component installed on a computing device.</li>
<li>Corpus Tag - A SWID or CoSWID tag that identifies and describes an installable software component in its pre-installation state. A corpus tag can be used to represent metadata about an installation package or installer for a software component, a software update, or a patch.</li>
<li>Supplemental Tag - A SWID or CoSWID tag that allows additional information to be associated with a referenced SWID tag. This helps to ensure that SWID Primary and Patch Tags provided by a software provider are not modified by software management tools, while allowing these tools to provide their own software metadata.</li>
</ol>
<p></p>

<ul class="empty"><li>Corpus, primary, and patch tags have similar functions in that they describe the existence and/or presence of different types of software (e.g., software installers, software installations, software patches), and, potentially, different states of software components. In contrast, supplemental tags furnish additional information not contained in corpus, primary, or patch tags. All four tag types come into play at various points in the software lifecycle, and support software management processes that depend on the ability to accurately determine where each software component is in its lifecycle.</li></ul>
<div id="rfc.figure.1"></div>
<div id="fig-lifecycle"></div>
<pre>
                                  +------------+
                                  v            |
Installation     Product       Product      Product       Product
  Media      -&gt; Installed  -&gt;  Patched   -&gt; Upgraded   -&gt; Removed
 Deployed

 Corpus         Primary        Primary      xPrimary      xPrimary
                Supplemental   Supplemental xSupplemental xSuplemental
                               Patch        xPatch
                                            Primary
                                            Supplemental

</pre>
<p class="figure">Figure 1: Use of Tag Types in the Software Lifecycle</p>
<p></p>

<ul class="empty"><li>
<a href="#fig-lifecycle" class="xref">Figure 1</a> illustrates the steps in the software lifecycle and the relationships among those lifecycle events supported by the four types of SWID and CoSWID tags, as follows:</li></ul>
<p></p>

<ul class="empty"><li><ul>
<li>Software Deployment. Before the software component is installed (i.e., pre-installation), and while the product is being deployed, a corpus tag provides information about the installation files and distribution media (e.g., CD/DVD, distribution package).</li>
<li>Software Installation. A primary tag will be installed with the software component (or subsequently created) to uniquely identify and describe the software component. Supplemental tags are created to augment primary tags with additional site-specific or extended information. While not illustrated in the figure, patch tags may also be installed during software installation to provide information about software fixes deployed along with the base software installation.</li>
<li>Software Patching. When a new patch is applied to the software component, a new patch tag is provided, supplying details about the patch and its dependencies. While not illustrated in the figure, a corpus tag can also provide information about the patch installer, and patching dependencies that need to be installed before the patch.</li>
<li>Software Upgrading. As a software component is upgraded to a new version, new primary and supplemental tags replace existing tags, enabling timely and accurate tracking of updates to software inventory. While not illustrated in the figure, a corpus tag can also provide information about the upgrade installer, and dependencies that need to be installed before the upgrade.</li>
<li>Software Removal. Upon removal of the software component, relevant SWID tags are removed. This removal event can trigger timely updates to software inventory reflecting the removal of the product and any associated patch or supplemental tags.</li>
</ul></li></ul>
<p id="rfc.section.1.1.p.8">Note: While not fully illustrated in the figure, supplemental tags can be associated with any corpus, primary, or patch tag to provide additional metadata about an installer, installed software, or installed patch respectively.</p>
<p id="rfc.section.1.1.p.9">Each of the different SWID and CoSWID tag types provide different sets of information. For example, a &#8220;corpus tag&#8221; is used to describe a software component&#8217;s installation image on an installation media, while a &#8220;patch tag&#8221; is meant to describe a patch that modifies some other software component.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#concise-swid-extensions" id="concise-swid-extensions">Concise SWID Extensions</a>
</h1>
<p id="rfc.section.1.2.p.1">This document defines the CoSWID format, a more concise representation of SWID information in the Concise Binary Object Representation (CBOR) <a href="#RFC7049" class="xref">[RFC7049]</a>. This is described via the Concise Data Definition Language (CDDL) <a href="#I-D.ietf-cbor-cddl" class="xref">[I-D.ietf-cbor-cddl]</a>. The resulting CoSWID data definition is interoperable with the XML schema definition of ISO-19770-2:2015 <a href="#SWID" class="xref">[SWID]</a>. The vocabulary, i.e., the CDDL names of the types and members used in the CoSWID data definition, are mapped to more concise labels represented as small integer values. The names used in the CDDL data definition and the mapping to the CBOR representation using integer labels is based on the vocabulary of the XML attribute and element names defined in ISO/IEC 19770-2:2015.</p>
<p id="rfc.section.1.2.p.2">The corresponding CoSWID data definition includes two kinds of augmentation.</p>
<p></p>

<ul>
<li>The explicit definition of types for attributes that are typically stored in the &#8220;any attribute&#8221; of an ISO-19770-2:2015 in XML representation. These are covered in <a href="#model-global-attributes" class="xref">Section 2.2</a> and <a href="#model-any-element" class="xref">Section 2.3</a> of this document.</li>
<li>The inclusion of extension points in the CoSWID data definition that allow for additional uses of CoSWID tags that go beyond the original scope of ISO-19770-2:2015 tags. These are covered in <a href="#model-payload" class="xref">Section 2.7.3</a> and <a href="#model-evidence" class="xref">Section 2.7.4</a>.</li>
</ul>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#requirements-notation" id="requirements-notation">Requirements Notation</a>
</h1>
<p id="rfc.section.1.3.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in RFC 2119, BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#concise-swid-data-definition" id="concise-swid-data-definition">Concise SWID Data Definition</a>
</h1>
<p id="rfc.section.2.p.1">The following is a CDDL representation for a CoSWID tag. This CDDL represetation is intended to be parallel to the XML schema definition in the ISO/IEC 19770-2:2015 <a href="#SWID" class="xref">[SWID]</a> specification, allowing both SWID and CoSWID tags to represent a common set of SWID information and to support all SWID tag use cases.  To achieve this end, the CDDL representation includes every SWID tag field and attribute. The CamelCase notation used in the XML schema definition is changed to a hyphen-separated notation (e.g. ResourceCollection is named resource-collection in the CoSWID data definition).  This deviation from the original notation used in the XML representation reduces ambiguity when referencing certain attributes in corresponding textual descriptions. An attribute referred by its name in CamelCase notation explicitly relates to XML SWID tags, an attribute referred by its name in hyphen-separated notation explicitly relates to CoSWID tags. This approach simplifies the composition of further work that reference both XML SWID and CoSWID documents.</p>
<p id="rfc.section.2.p.2">Human-readable names of members in the CDDL data definition are mapped to integer indices via a block of rules at the bottom of the definition. The 67 character strings of the SWID vocabulary that would have to be stored or transported in full if using the original vocabulary are replaced.</p>
<p id="rfc.section.2.p.3">In CBOR, an array is encoded using bytes that identify the array, and the array&#8217;s length or stop point (see <a href="#RFC7049" class="xref">[RFC7049]</a>). To make items that support 1 or more values, the following CDDL notion is used.</p>
<pre>
_name_ = (_label_: _data_ / [ 2* _data_ ])
</pre>
<p id="rfc.section.2.p.4">The CDDL above allows for a more effecient CBOR encoding of the data when a single value is used by avoiding the need to first encode the array. An array is used for two or more values. This modeling pattern is used frequently in the CoSWID CDDL data definition in such cases.</p>
<p id="rfc.section.2.p.5">The following subsections describe the different parts of the CoSWID model.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#model-concise-software-identity" id="model-concise-software-identity">The concise-software-identity Object</a>
</h1>
<p id="rfc.section.2.1.p.1">The CDDL for the main concise-software-identity object is as follows:</p>
<pre>
concise-software-identity = {
  global-attributes,
  tag-id,
  tag-version,
  ? corpus,
  ? patch,
  ? supplemental,
  swid-name,
  ? software-version,
  ? version-scheme,
  ? media,
  ? software-meta-entry,
  ? entity-entry,
  ? link-entry,
  ? ( payload-entry / evidence-entry ),
  ? any-element-entry,
}
tag-id = (0: text)
swid-name = (1: text)
entity-entry = (2: entity / [ 2* entity ])
evidence-entry = (3: evidence)
link-entry = (4: link / [ 2* link ])
software-meta-entry = (5: software-meta / [ 2* software-meta ])
payload-entry = (6: payload)
any-element-entry = (7: any-element-map / [ 2* any-element-map ])
corpus = (8: bool)
patch = (9: bool)
media = (10: text)
supplemental = (11: bool)
tag-version = (12: integer)
software-version = (13: text)
version-scheme = (14: text)
</pre>
<p id="rfc.section.2.1.p.2">The following describes each child item of the concise-software-identity object model.</p>
<p></p>

<ul>
<li>global-attributes: A list of items including an optional language definition to support the processing of text-string values and an unbounded set of any-attribute items. Described in <a href="#model-global-attributes" class="xref">Section 2.2</a>.</li>
<li>tag-id (label 0): An textual identifier uniquely referencing a (composite) software component. The tag identifier MUST be globally unique. There are no strict guidelines on how this identifier is structured, but examples include a 16 byte GUID (e.g.  class 4 UUID) <a href="#RFC4122" class="xref">[RFC4122]</a>.</li>
<li>tag-version (label 12): An integer value that indicates if a specific release of a software component has more than one tag that can represent that specific release. Typically, the initial value of this field is set to 0, and the value is monotonically increased for subsequent tags produced for the same software component release. This item is used when a CoSWID tag producer creates and releases an incorrect tag that they subsequently want to fix, but no underlying changes have been made to the product the CoSWID tag represents. This could happen if, for example, a patch is distributed that has a link reference that does not cover all the various software releases it can patch. A newer CoSWID tag for that patch can be generated and the tag-version value incremented to indicate that the data is updated.</li>
<li>corpus (label 8): A boolean value that indicates if the tag identifies and describes an installable software component in its pre-installation state. Installable software includes a installation package or installer for a software component, a software update, or a patch. If the CoSWID tag represents installable software, the corpus item MUST be set to &#8220;true&#8221;. If not provided the default value MUST be considered &#8220;false&#8221;.</li>
<li>patch (label 9): A boolean value that indicates if the tag identifies and describes an installed patch which has made incremental changes to a software component installed on a computing device. Typically, an installed patch has made a set of file modifications to pre-installed software, and does not alter the version number or the descriptive metadata of an installed software component. If a CoSWID tag is for a patch, it MUST contain the patch item and its value MUST be set to &#8220;true&#8221;. If not provided the default value MUST be considered &#8220;false&#8221;.</li>
<li>supplemental (label 11): A boolean value that indicates if the tag is providing additional information to be associated with another referenced SWID or CoSWID tag. Tags using this item help to ensure that primary and patch tags provided by a software provider are not modified by software management tools, while allowing these tools to provide their own software metadata for a software component. If a CoSWID tag is a supplemntal tag, it MUST contain the supplemental item and its value MUST be set to &#8220;true&#8221;. If not provided the default value MUST be considered &#8220;false&#8221;.</li>
<li>swid-name (label 1): This textual item provides the software component name as it would typically be referenced.  For example, what would be seen in the add/remove software dialog in an operating system, or what is specified as the name of a packaged software component or a patch identifier name.</li>
<li>software-version (label 13): A textual value representing the specific underlying release or development version of the software component.</li>
<li>version-scheme (label 14): An 8-bit integer or textual value representing the versioning scheme used for the software-version item. If an integer value is used it MUST be a value from the registry (see section <a href="#iana-version-scheme" class="xref">Section 4.1</a> or a value in the private use range: 32768-65,535.</li>
<li>media (label 10): This text value is a hint to the tag consumer to understand what this tag applies to. This item represents a query as defined by the W3C Media Queries Recommendation (see http://www.w3.org/TR/css3-mediaqueries/). A hint to the consumer of the link to what the target item is applicable for.</li>
<li>software-meta-entry (label 5): An open-ended collection of key/value data related to this CoSWID.  A number of predefined attributes can be used within this item providing for common usage and semantics across the industry.  The data definition of this entry allows for any additional attribute to be included, though it is recommended that industry norms for new attributes are defined and followed to the degree possible. Described in <a href="#model-software-meta" class="xref">Section 2.6</a>.</li>
<li>entity-entry (label 2): Specifies the organizations related to the software component referenced by this CoSWID tag. Described in <a href="#model-entity" class="xref">Section 2.4</a>.</li>
<li>link-entry (label 4): Provides a means to establish a relationship arc between the tag and another item. A link can be used to establish relationships between tags and to reference other resources that are related to the CoSWID tag, e.g.  vulnerability database associations, ROLIE feeds, MUD files, software download location, etc).  This is modeled after the HTML &#8220;link&#8221; element.  Described in <a href="#model-link" class="xref">Section 2.5</a>.</li>
</ul>
<p></p>

<ul>
<li>payload-entry (label 6): The items that may be installed on a system entity when the software component is installed.  Note that payload may be a superset of the items installed and - depending on optimization mechanisms in respect to that system entity - may or may not include every item that could be created or executed on the corresponding system entitiy when software components are installed.  In general, payload will be used to indicate the files that may be installed with a software component. Therefore payload will often be a superset of those files (i.e. if a particular optional sub-component is not installed, the files associated with that software component may be included in payload, but not installed in the system entity). Described in <a href="#model-payload" class="xref">Section 2.7.3</a>.</li>
<li>evidence-entry (label 3): This item is used to provide results from a scan of a system where software that does not have a CoSWID tag is discovered. This information is not provided by the software-creator, and is instead created when a system is being scanned and the evidence for why software is believed to be installed on the device is provided in the evidence item. Described in <a href="#model-evidence" class="xref">Section 2.7.4</a>.</li>
<li>any-element-entry (label 7): A default map that can contain arbitrary map members and even nested maps (which would also be any-elements). In essence, the any-element allows items not defined in this CDDL data definition to be included in a Concise Software Identifier. Described in <a href="#model-any-element" class="xref">Section 2.3</a>.</li>
</ul>
<h1 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> <a href="#determining-the-tag-type" id="determining-the-tag-type">Determining the tag type</a>
</h1>
<p id="rfc.section.2.1.1.p.1">The operational model for SWID and CoSWID tags introduced in <a href="#intro-lifecycle" class="xref">Section 1.1</a>. The following rules can be used to determine the type of a CoSWID tag.</p>
<p></p>

<ul>
<li>Corpus Tag: A CoSWID tag MUST be considered a corpus tag if the corpus item is &#8220;true&#8221;.</li>
<li>Primary Tag: A CoSWID tag MUST be considered a primary tag if the corpus, patch, and supplemental items are &#8220;false&#8221;.</li>
<li>Patch Tag: A CoSWID tag MUST be considered a patch tag if the patch item is &#8220;true&#8221; and the corpus item is &#8220;false&#8221;.</li>
<li>Supplemental Tag: A CoSWID tag MUST be considered a supplemental tag if the supplemental item is set to &#8220;true&#8221;.</li>
</ul>
<p id="rfc.section.2.1.1.p.3">A tag that does not match one of the above rules MUST be considered an invalid, unsupported tag type.</p>
<p id="rfc.section.2.1.1.p.4">If a patch modifies the version number or the descriptive metadata of the software, then a new tag representing these details SHOULD be installed, and the old tag SHOULD be removed.</p>
<h1 id="rfc.section.2.1.2">
<a href="#rfc.section.2.1.2">2.1.2.</a> <a href="#concise-software-identity-co-constraints" id="concise-software-identity-co-constraints">concise-software-identity Co-constraints</a>
</h1>
<p></p>

<ul>
<li>Only one of the corpus, patch, and supplemental items MUST be set to &#8220;true&#8221;, or all of the corpus, patch, and supplemental items MUST be set to &#8220;false&#8221; or be omitted.</li>
<li>If the patch item is set to &#8220;true&#8221;, the the tag SHOULD contain at least one link with the rel(ation) item value of &#8220;patches&#8221; and an href item specifying an association with the software that was patched.</li>
<li>If the supplemental item is set to &#8220;true&#8221;, the the tag SHOULD contain at least one link with the rel(ation) item value of &#8220;supplements&#8221; and an href item specifying an association with the software that is supplemented.</li>
<li>If all of the corpus, patch, and supplemental items are &#8220;false&#8221;, or if the corpus item is set to &#8220;true&#8221;, then a software-version item MUST be included with a value set to the version of the software component. This ensures that primary and corpus tags have an identifiable software version.</li>
</ul>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#model-global-attributes" id="model-global-attributes">The global-attributes Group</a>
</h1>
<p id="rfc.section.2.2.p.1">The global-attributes group provides a list of items including an optional language definition to support the processing of text-string values and an unbounded set of any-attribute items allowing for additional items to be provided as a general point of extension in the model.</p>
<p id="rfc.section.2.2.p.2">The CDDL for the global-attributes is as follows:</p>
<pre>
global-attributes = (
  ? lang,
  * any-attribute,
)

label = text / int

any-attribute = (
  label =&gt; text / int / [ 2* text ] / [ 2* int ]
)

lang = (15: text)
</pre>
<p id="rfc.section.2.2.p.3">The following describes each child item of this object.</p>
<p></p>

<ul>
<li>lang (index 15): A language tag or corresponding IANA index integer that conforms with IANA Language Subtag Registry <a href="#RFC5646" class="xref">[RFC5646]</a>. </li>
<li>any-attribute: This sub-group provides a means to include arbitrary information via label (key) item value pairs where both keys and values can be either a single integer or text string, or an array of integers or text strings.</li>
</ul>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#model-any-element" id="model-any-element">The any-element-map Entry</a>
</h1>
<p id="rfc.section.2.3.p.1">The CDDL for the any-element-entry object is as follows:</p>
<pre>
any-element-map = {
  global-attributes,
  * label =&gt; any-element-map / [ 2* any-element-map ],
}
any-element-entry = (7: any-element-map / [ 2* any-element-map ])
</pre>
<p id="rfc.section.2.3.p.2">The following describes each child item of this object.</p>
<p></p>

<ul>
<li>global-attributes: The global-attributes group described in <a href="#model-global-attributes" class="xref">Section 2.2</a>.</li>
<li>label: a single or multiple </li>
</ul>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> <a href="#model-entity" id="model-entity">The entity Object</a>
</h1>
<p id="rfc.section.2.4.p.1">The CDDL for the entity object is as follows:</p>
<pre>
entity = {
  global-attributes,
  entity-name,
  ? reg-id,
  role,
  ? thumbprint,
  extended-data,
}

any-uri = text

extended-data = (30: any-element-map / [ 2* any-element-map ])
entity-name = (31: text)
reg-id = (32: any-uri)
role = (33: text / [2* text])
thumbprint = (34: hash-entry)
</pre>
<p id="rfc.section.2.4.p.2">The following describes each child item of this object.</p>
<p></p>

<ul>
<li>global-attributes: The global-attributes group described in <a href="#model-global-attributes" class="xref">Section 2.2</a>.</li>
<li>entity-name (index 32): The text-string name of the organization claiming a particular role in the CoSWID tag.</li>
<li>reg-id (index 32): The registration id is intended to uniquely identify a naming authority in a given scope (e.g. global, organization, vendor, customer, administrative domain, etc.) that is implied by the referenced naming authority. The value of an registration ID MUST be a RFC 3986 URI. The scope SHOULD be the scope of an organization. In a given scope, the registration id MUST be used consistently.</li>
<li>role (index 33): The relationship(s) between this organization and this tag. The role of tag creator is required for every CoSWID tag. The role of an entity may include any role value, but the pre-defined roles include: &#8220;aggregator&#8221;, &#8220;distributor&#8221;, &#8220;licensor&#8221;, &#8220;software-creator&#8221;, and &#8220;tag-creator&#8221;. These pre-defined role index and text values are defined in <a href="#indexed-entity-role" class="xref">Section 3.2</a>. Use of index values instead of text for these pre-defined roles allows a CoSWID to be more concise.</li>
<li>thumbprint (index 34): The value of the thmbprint item provides an integer-based hash algorithm identifier (hash-alg-id) and a byte string string value (hash-value) that contains the corresponding hash value (i.e. the thumbprint) of the signing entities certificate(s). If the hash-alg-id is not known, then the integer value &#8220;0&#8221; MUST be used. This ensures parity between the SWID tag specification <a href="#SWID" class="xref">[SWID]</a>, which does not allow an algorithm to be identified for this field. See <a href="#model-hash-entry" class="xref">Section 2.7.1</a> for more details on the use of the hash-entry data structure.</li>
<li>extended-data (index 30): An open-ended collection of elements that can be used to attach arbitrary metadata to an entity item.</li>
</ul>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> <a href="#model-link" id="model-link">The link Object</a>
</h1>
<p id="rfc.section.2.5.p.1">The CDDL for the link object is as follows:</p>
<pre>
link = {
  global-attributes,
  ? artifact,
  href,
  ? media
  ? ownership,
  rel,
  ? media-type,
  ? use,
}
artifact = (37: text)
href = (38: any-uri)
media = (10: any-uri)
ownership = (39: "shared" / "private" / "abandon")
rel = (40: text)
media-type = (41: text)
use = (42: "optional" / "required" / "recommended")
</pre>
<p id="rfc.section.2.5.p.2">The following describes each child item of this object.</p>
<p></p>

<ul>
<li>global-attributes: The global-attributes group described in <a href="#model-global-attributes" class="xref">Section 2.2</a>.</li>
<li>artifact (index: 37): For installation media (rel=&#8221;installation-media&#8221;), this item value indicates the path of the installer executable or script that can be run to launch the referenced installation. Items with the same artifact name should be considered mirrors of each other, allowing the installation media to be downloaded from any of the described sources.</li>
<li>href (index 38): The link to the item being referenced. The &#8220;href&#8221; item&#8217;s value can point to several different things, and can be any of the following: <ul>
<li>If no URI scheme is provided, then the URI is to be interpreted as being relative to the URI of the CoSWID tag. For example, &#8220;./folder/supplemental.coswid&#8221;.</li>
<li>a physical resource location with any system-acceptable URI scheme (e.g., file:// http:// https:// ftp://)</li>
<li>a URI with &#8220;coswid:&#8221; as the scheme, which refers to another CoSWID by tag-id. This URI would need to be resolved in the context of the system by software that can lookup other CoSWID tags. For example, &#8220;coswid:2df9de35-0aff-4a86-ace6-f7dddd1ade4c&#8221; references the tag with the tag-id value &#8220;2df9de35-0aff-4a86-ace6-f7dddd1ade4c&#8221;.</li>
<li>a URI with &#8220;swidpath:&#8221; as the scheme, which refers to another CoSIWD via an XPATH query. This URI would need to be resolved in the context of the system entity via dedicated software components that can lookup other CoSWID tags and select the appropriate tag based on an XPATH query. Examples include:</li>
<li>swidpath://SoftwareIdentity[Entity/@regid=&#8217;http://contoso.com&#8217;] would retrieve all CoSWID tags that include an entity where the regid is &#8220;Contoso&#8221; or swidpath://SoftwareIdentity[Meta/@persistentId=&#8217;b0c55172-38e9-4e36-be86-92206ad8eddb&#8217;] would match CoSWID tags with the persistent-id value &#8220;b0c55172-38e9-4e36-be86-92206ad8eddb&#8221;.</li>
<li>See XPATH query standard : http://www.w3.org/TR/xpath20/ </li>
</ul>
</li>
<li>media (index 10): See media defined in <a href="#model-concise-software-identity" class="xref">Section 2.1</a>.</li>
<li>ownership (index 39): Determines the relative strength of ownership of the software components. Valid enumerations are: abandon, private, shared</li>
<li>rel (index 40): The relationship between this CoSWID and the target file. Relationships can be identified by referencing the IANA registration library: https://www.iana.org/assignments/link-relations/link-relations.xhtml.</li>
<li>media-type (index 41): The IANA MediaType for the target file; this provides the consumer with intelligence of what to expect. See http://www.iana.org/assignments/media-types/media-types.xhtml for more details on link type.</li>
<li>use (index 42): Determines if the target software is a hard requirement or not. Valid enumerations are: required, recommended, optional.</li>
</ul>
<h1 id="rfc.section.2.6">
<a href="#rfc.section.2.6">2.6.</a> <a href="#model-software-meta" id="model-software-meta">The software-meta Object</a>
</h1>
<p id="rfc.section.2.6.p.1">The CDDL for the software-meta object is as follows:</p>
<pre>
software-meta = {
  global-attributes,
  ? activation-status,
  ? channel-type,
  ? colloquial-version,
  ? description,
  ? edition,
  ? entitlement-data-required,
  ? entitlement-key,
  ? generator,
  ? persistent-id,
  ? product,
  ? product-family,
  ? revision,
  ? summary,
  ? unspsc-code,
  ? unspsc-version,
}
activation-status = (43: text)
channel-type = (44: text)
colloquial-version = (45: text)
description = (46: text)
edition = (47: text)
entitlement-data-required = (48: bool)
entitlement-key = (49: text)
generator = (50: text)
persistent-id = (51: text)
product = (52: text)
product-family = (53: text)
revision = (54: text)
summary = (55: text)
unspsc-code = (56: text)
unspsc-version = (57: text)
</pre>
<p id="rfc.section.2.6.p.2">The following describes each child item of this object.</p>
<p></p>

<ul>
<li>global-attributes: The global-attributes group described in <a href="#model-global-attributes" class="xref">Section 2.2</a>.</li>
<li>activation-status (index 43): Identification of the activation status of this software title (e.g. Trial, Serialized, Licensed, Unlicensed, etc).  Typically, this is used in supplemental tags.</li>
<li>channel-type (index 44): Provides information on which channel this particular software was targeted for (e.g. Volume, Retail, OEM, Academic, etc). Typically used in supplemental tags.</li>
<li>colloquial-version (index 45): The informal or colloquial version of the product (i.e. 2013). Note that this version may be the same through multiple releases of a software component where the version specified in entity is much more specific and will change for each software release.  Note that this representation of version is typically used to identify a group of specific software releases that are part of the same release/support infrastructure (i.e. Fabrikam Office 2013).  This version is used for string comparisons only and is not compared to be an earlier or later release (that is done via the entity version). </li>
<li>description (index 46): A longer, detailed description of the software.  This description can be multiple sentences (differentiated from summary, which is a very short, one-sentence description).</li>
<li>edition (index 47): The variation of the product (Extended, Enterprise, Professional, Standard etc).</li>
<li>entitlement-data-required (index 48): An indicator to determine if there should be accompanying proof of entitlement when a software license reconciliation is completed.</li>
<li>entitlement-key (index 49): A vendor-specific textual key that can be used to reconcile the validity of an entitlement. (e.g. serial number, product or license key).</li>
<li>generator (index 50): The name of the software tool that created a CoSWID tag.  This item is typically used if tags are created on the fly or via a catalog-based analysis for data found on a computing device.</li>
<li>persistent-id (index 51): A GUID used to represent products installed where the products are related, but may be different versions.</li>
<li>product (index 52): The base name of the product (e.g. ).</li>
<li>product-family (index 53): The overall product family this software belongs to.  Product family is not used to identify that a product is part of a suite, but is instead used when a set of products that are all related may be installed on multiple different devices.  For example, an enterprise backup system may consist of a backup services, multiple different backup services that support mail services, databases and ERP systems, as well as individual software components that backup client system entities. In such an usage scenario, all software components that are part of the backup system would have the same product-family name so they can be grouped together in respect to reporting systems.</li>
<li>revision (index 54): The informal or colloquial representation of the sub-version of the given product (ie, SP1, R2, RC1, Beta 2, etc).  Note that the version will provide very exact version details, the revision is intended for use in environments where reporting on the informal or colloquial representation of the software is important (for example, if for a certain business process, an organization recognizes that it must have, for example &#8220;ServicePack 1&#8221; or later of a specific product installed on all devices, they can use the revision data value to quickly identify any devices that do not meet this requirement).  Depending on how a software organizations distributes revisions, this value could be specified in a primary (if distributed as an upgrade) or supplemental (if distributed as a patch) CoSWID tag.</li>
<li>summary (index 55): A short (one-sentence) description of the software.</li>
<li>unspsc-code (index 56): An 8 digit code that provides UNSPSC classification of the software component this SWID tag identifies.  For more information see, http://www.unspsc.org/.</li>
<li>unspsc-version (index 57): The version of the UNSPSC code used to define the UNSPSC code value. For more information see, http://www.unspsc.org/.</li>
</ul>
<h1 id="rfc.section.2.7">
<a href="#rfc.section.2.7">2.7.</a> <a href="#the-resource-collection-definition" id="the-resource-collection-definition">The Resource Collection Definition</a>
</h1>
<h1 id="rfc.section.2.7.1">
<a href="#rfc.section.2.7.1">2.7.1.</a> <a href="#model-hash-entry" id="model-hash-entry">The hash-entry Array</a>
</h1>
<p id="rfc.section.2.7.1.p.1">CoSWID add explicit support for the representation of hash entries using algorithms that are registered at the Named Information Hash Algorithm Registry via the hash-entry member (label 58).</p>
<pre>
hash-entry = (58: [ hash-alg-id: int, hash-value: bstr ] )
</pre>
<p id="rfc.section.2.7.1.p.2">The number used as a value for hash-alg-id MUST refer an ID in the Named Information Hash Algorithm Registry; other hash algorithms MUST NOT be used. The hash-value MUST represent the raw hash value of the hashed resource generated using the hash algorithm indicated by the hash-alg-id.</p>
<h1 id="rfc.section.2.7.2">
<a href="#rfc.section.2.7.2">2.7.2.</a> <a href="#model-resource-collection" id="model-resource-collection">The resource-collection Group</a>
</h1>
<p id="rfc.section.2.7.2.p.1">A list of items both used in evidence (discovered by an inventory process) and payload (installed in a system entity) content of a CoSWID tag document to structure and differentiate the content of specific CoSWID tag types. Potential content includes directories, files, processes, resources or firmwares.</p>
<p id="rfc.section.2.7.2.p.2">The CDDL for the resource-collection group is as follows:</p>
<pre>
resource-collection = (
  ? directory-entry,
  ? file-entry,
  ? process-entry,
  ? resource-entry
)

directory = {
  filesystem-item,
  path-elements,
}

file = {
  filesystem-item,
  ? size,
  ? file-version,
  ? hash-entry,
}

process = {
  global-attributes,
  process-name,
  ? pid,
}

resource = {
  global-attributes,
  type,
}

filesystem-item = (
  global-attributes,
  ? key,
  ? location,
  fs-name,
  ? root,
)

directory-entry = (16: directory / [ 2* directory ])
file-entry = (17: file / [ 2* file ])
process-entry = (18: process / [ 2* process ])
resource-entry = (19: resource / [ 2* resource ])
size = (20: integer)
file-version = (21: text)
key = (22: bool)
location = (23: text)
fs-name = (24: text)
root = (25: text)
path-elements = (26: { * file-entry,
                       * directory-entry,
                     }
                )
process-name = (27: text)
pid = (28: integer)
type = (29: text)
</pre>
<p id="rfc.section.2.7.2.p.3">The following describes each child item or group for these groups.</p>
<p></p>

<ul>
<li>filesystem-item: A list of items both used in representing the nodes of a file-system hierarchy, i.e. directory items that allow one or more directories to be defined in the file structure, and file items that allow one or more files to be specified for a given location.</li>
<li>global-attributes: The global-attributes group described in <a href="#model-global-attributes" class="xref">Section 2.2</a>.</li>
<li>directory-entry (index 16): A directory item allows one or more directories to be defined in the file structure.</li>
<li>file-entry (index 17): A file element that allows one or more files to be specified for a given location.</li>
<li>process-entry (index 18): Provides process (software component in execution) information for data that will show up in a devices process table.</li>
<li>resource-entry (index 19): A set of items that can be used to provide arbitrary resource information about an application installed on a system entity, or evidence collected from a system entity.</li>
<li>size (index 20): The file size in bytes of the file.</li>
<li>file-version (index 21): The version of the file.</li>
<li>key (index 22): Files that are considered important or required for the use of a software component.  Typical key files would be those which, if not available on a system entity, would cause the software component not to execute or function properly.  Key files will typically be used to validate that a software component referenced by the CoSWID tag document is actually installed on a specific system entity.</li>
<li>location (index 23): The directory or location where a file was found or can expected to be located.  This text-string is intended to include the filename itself.  This SHOULD be the relative path from the location represented by the root item.</li>
<li>fs-name (index 24): The file name or directory name without any path characters.</li>
<li>root (index 25): A system-specific root folder that the location item is an offset from. If this is not specified the assumption is the root is the same folder as the location of the CoSWID tag. The text-string value represents a path expression relative to the CoSWID tag document location in the (composite) file-system hierarchy.</li>
<li>path-elements (index 26): Provides the ability to apply a directory structure to the path expressions for files defined in a payload or evidence item.</li>
<li>process-name (index 27): The process name as it will be found in the system entity&#8217;s process table.</li>
<li>pid (index 28): The process ID for the process in execution that can be included in the process item as part of an evidence tag.</li>
<li>type (index 29): The type of resource represented via a text-string  (typically, registry-key, port or root-uri).</li>
</ul>
<h1 id="rfc.section.2.7.3">
<a href="#rfc.section.2.7.3">2.7.3.</a> <a href="#model-payload" id="model-payload">The payload Object</a>
</h1>
<p id="rfc.section.2.7.3.p.1">The CDDL for the payload object is as follows:</p>
<pre>
payload = {
  global-attributes,
  resource-collection,
  * $$payload-extension
}
</pre>
<p id="rfc.section.2.7.3.p.2">The following describes each child item of this object.</p>
<p></p>

<ul>
<li>global-attributes: The global-attributes group described in <a href="#model-global-attributes" class="xref">Section 2.2</a>.</li>
<li>resource-collection: The resource-collection group described in <a href="#model-resource-collection" class="xref">Section 2.7.2</a>.</li>
<li>$$payload-extension: This CDDL socket (see <a href="#I-D.ietf-cbor-cddl" class="xref">[I-D.ietf-cbor-cddl]</a> section 3.9) can be used to extend the payload model, allowing well-formed extensions to be defined in additional CDDL descriptions.</li>
</ul>
<h1 id="rfc.section.2.7.4">
<a href="#rfc.section.2.7.4">2.7.4.</a> <a href="#model-evidence" id="model-evidence">The evidence Object</a>
</h1>
<p id="rfc.section.2.7.4.p.1">The CDDL for the evidence object is as follows:</p>
<pre>
evidence = {
  global-attributes,
  resource-collection,
  ? date,
  ? device-id,
  * $$evidence-extension
}
date = (35: time)
device-id = (36: text)
</pre>
<p id="rfc.section.2.7.4.p.2">The following describes each child item of this object.</p>
<p></p>

<ul>
<li>global-attributes: The global-attributes group described in <a href="#model-global-attributes" class="xref">Section 2.2</a>.</li>
<li>resource-collection: The resource-collection group described in <a href="#model-resource-collection" class="xref">Section 2.7.2</a>.</li>
<li>date (index 35): The date and time evidence represented by an evidence item was gathered.</li>
<li>device-id (index 36): A text-string identifier for a device evidence was gathered from.</li>
<li>$$evidence-extension:  This CDDL socket (see <a href="#I-D.ietf-cbor-cddl" class="xref">[I-D.ietf-cbor-cddl]</a> section 3.9) can be used to extend the evidence model, allowing well-formed extensions to be defined in additional CDDL descriptions.</li>
</ul>
<h1 id="rfc.section.2.8">
<a href="#rfc.section.2.8">2.8.</a> <a href="#full-cddl-definition" id="full-cddl-definition">Full CDDL Definition</a>
</h1>
<p id="rfc.section.2.8.p.1">In order to create a valid CoSWID document the structure of the corresponding CBOR message MUST adhere to the following CDDL data definition.</p>
<pre>
concise-software-identity = {
  global-attributes,
  tag-id,
  tag-version,
  ? corpus,
  ? patch,
  ? supplemental,
  swid-name,
  ? software-version,
  ? version-scheme,
  ? media,
  ? software-meta-entry,
  entity-entry,
  ? link-entry,
  ? ( payload-entry // evidence-entry ),
  * $$coswid-extension 
}

any-uri = text
label = text / int

any-attribute = (
  label =&gt; text / int / [ 2* text ] / [ 2* int ]
)

global-attributes = (
  ? lang,
  * any-attribute,
)

resource-collection = (
  ? directory-entry,
  ? file-entry,
  ? process-entry,
  ? resource-entry
)

file = {
  filesystem-item,
  ? size,
  ? file-version,
  ? hash-entry,
}

filesystem-item = (
  global-attributes,
  ? key,
  ? location,
  fs-name,
  ? root,
)

directory = {
  filesystem-item,
  path-elements,
}

process = {
  global-attributes,
  process-name,
  ? pid,
}

resource = {
  global-attributes,
  type,
}

entity = {
  global-attributes,
  entity-name,
  ? reg-id,
  role,
  ? thumbprint,
  * $$entity-extension,
}

evidence = {
  global-attributes,
  resource-collection,
  ? date,
  ? device-id,
  * $$evidence-extension 
}

link = {
  global-attributes,
  ? artifact,
  href,
  ? media
  ? ownership,
  rel,
  ? media-type,
  ? use,
}

software-meta = {
  global-attributes,
  ? activation-status,
  ? channel-type,
  ? colloquial-version,
  ? description,
  ? edition,
  ? entitlement-data-required,
  ? entitlement-key,
  ? generator,
  ? persistent-id,
  ? product,
  ? product-family,
  ? revision,
  ? summary,
  ? unspsc-code,
  ? unspsc-version,
}

payload = {
  global-attributes,
  resource-collection,
  * $$payload-extension 
}

tag-id = (0: text)
swid-name = (1: text)
entity-entry = (2: entity / [ 2* entity ])
evidence-entry = (3: evidence)
link-entry = (4: link / [ 2* link ])
software-meta-entry = (5: software-meta / [ 2* software-meta ])
payload-entry = (6: payload)
corpus = (8: bool)
patch = (9: bool)
media = (10: [ + [ media-expression,
                     ? [ media-operation,
                         media-expression,
                       ]
                 ]
             ])
media-operation = text
media-expression = media-environment / [ media-prefix,
                                         media-environment,
                                         media-attribute,
                                         media-value,
                                       ]
media-prefix = text
media-environment = text
media-attribute = text
media-value = text
supplemental = (11: bool)
tag-version = (12: integer)
software-version = (13: text)
version-scheme = (14: version-schemes  / extended-value)
version-schemes = multipartnumeric / multipartnumeric-suffix / alphanumeric / decimal / semver
multipartnumeric = 1
multipartnumeric-suffix = 2
alphanumeric = 3
decimal = 4
semver = 16384
lang = (15: text)
directory-entry = (16: directory / [ 2* directory ])
file-entry = (17: file / [ 2* file ])
process-entry = (18: process / [ 2* process ])
resource-entry = (19: resource / [ 2* resource ])
size = (20: integer)
file-version = (21: text)
key = (22: bool)
location = (23: text)
fs-name = (24: text)
root = (25: text)
path-elements = (26: { * file-entry,
                       * directory-entry,
                     }
                )
process-name = (27: text)
pid = (28: integer)
type = (29: text)
entity-name = (31: text)
reg-id = (32: any-uri)
role = (33: roles / extended-value / [ 2* roles / extended-value ] )
extended-value = text / uint
roles= aggregator / distributor / licensor / software-creator / tag-creator
aggregator=0
distributor=1
licensor=2
software-creator=3
tag-creator=4
thumbprint = (34: [ hash-alg-id: int,
                    hash-value: bstr,
                  ]
             )
date = (35: time)
device-id = (36: text)
artifact = (37: text)
href = (38: any-uri)
ownership = (39: shared / private / abandon / extended-value )
shared=0
private=1
abandon=2
rel = (40: rels / extended-value )
rels = ancestor / component / feature / installationmedia / packageinstaller / parent / patches / requires / see-also / supersedes / rel-supplemental
ancestor=0
component=1
feature=2
installationmedia=3
packageinstaller=4
parent=5
patches=6
requires=7
see-also=8
supersedes=9
rel-supplemental=10
media-type = (41: text)
use = (42: optional / required / recommended / extended-value )
optional=0
required=1
recommended=2
activation-status = (43: text)
channel-type = (44: text)
colloquial-version = (45: text)
description = (46: text)
edition = (47: text)
entitlement-data-required = (48: bool)
entitlement-key = (49: text)
generator = (50: text)
persistent-id = (51: text)
product = (52: text)
product-family = (53: text)
revision = (54: text)
summary = (55: text)
unspsc-code = (56: text)
unspsc-version = (57: text)
hash-entry = (58: [ hash-alg-id: int,
                    hash-value: bstr,
                  ]
             )
</pre>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#coswid-indexed-label-values" id="coswid-indexed-label-values">CoSWID Indexed Label Values</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#indexed-version-scheme" id="indexed-version-scheme">Version Scheme</a>
</h1>
<p id="rfc.section.3.1.p.1">The following are an initial set of values for use in the version-scheme item for the version schemes defined in the ISO/IEC 19770-2:2015 <a href="#SWID" class="xref">[SWID]</a> specification. Index value in parens indicates the index value to use in the version-scheme item.</p>
<p></p>

<ul>
<li>multipartnumeric (index 1): Numbers separated by dots, where the numbers are interpreted as integers (e.g.,1.2.3, 1.4.5, 1.2.3.4.5.6.7)</li>
<li>multipartnumeric+suffix (index 2): Numbers separated by dots, where the numbers are interpreted as integers with an additional string suffix(e.g., 1.2.3a)</li>
<li>alphanumeric (index 3): Strictly a string, sorting is done alphanumerically</li>
<li>decimal (index 4): A floating point number (e.g., 1.25 is less than 1.3)</li>
<li>semver (index 16384): Follows the <a href="#SEMVER" class="xref">[SEMVER]</a> specification</li>
</ul>
<p id="rfc.section.3.1.p.3">The values above are registered in the &#8220;SWID/CoSWID Version Schema Values&#8221; registry defined in section <a href="#iana-version-scheme" class="xref">Section 4.1</a>. Additional valid values will likely be registered over time in this registry.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#indexed-entity-role" id="indexed-entity-role">Entity Role Values</a>
</h1>
<p id="rfc.section.3.2.p.1">The following table indicates the index value to use for the entity roles defined in the ISO/IEC 19770-2:2015 <a href="#SWID" class="xref">[SWID]</a> specification.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Index</th>
<th class="left">Role Name</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0</td>
<td class="left">Reserved</td>
</tr>
<tr>
<td class="left">1</td>
<td class="left">tagCreator</td>
</tr>
<tr>
<td class="left">2</td>
<td class="left">softwareCreator</td>
</tr>
<tr>
<td class="left">3</td>
<td class="left">aggregator</td>
</tr>
<tr>
<td class="left">4</td>
<td class="left">distributor</td>
</tr>
<tr>
<td class="left">5</td>
<td class="left">licensor</td>
</tr>
</tbody>
</table>
<p id="rfc.section.3.2.p.2">The values above are registered in the &#8220;SWID/CoSWID Entity Role Values&#8221; registry defined in section <a href="#iana-entity-role" class="xref">Section 4.2</a>. Additional valid values will likely be registered over time. Additionally, the index values 226 through 255 have been reserved for private use.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.4.p.1">This document will include requests to IANA:</p>
<p></p>

<ul>
<li>Integer indices for SWID content attributes and information elements.</li>
<li>Content-Type for CoAP to be used in COSE.</li>
</ul>
<p id="rfc.section.4.p.3">This document has a number of IANA considerations, as described in the following subsections.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#iana-version-scheme" id="iana-version-scheme">SWID/CoSWID Version Schema Values Registry</a>
</h1>
<p id="rfc.section.4.1.p.1">This document uses unsigned 16-bit index values to version-scheme item values. The initial set of version-scheme values are derived from the textual version scheme names defined in the ISO/IEC 19770-2:2015 specification <a href="#SWID" class="xref">[SWID]</a>.</p>
<p id="rfc.section.4.1.p.2">This document defines a new a new registry entitled &#8220;SWID/CoSWID Version Schema Values&#8221;. Future registrations for this registry are to be made based on <a href="#RFC8126" class="xref">[RFC8126]</a> as follows:</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Range</th>
<th class="left">Registration Procedures</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0-16383</td>
<td class="left">Standards Action</td>
</tr>
<tr>
<td class="left">16384-32767</td>
<td class="left">Specification Required</td>
</tr>
<tr>
<td class="left">32768-65535</td>
<td class="left">Reserved for Private Use</td>
</tr>
</tbody>
</table>
<p id="rfc.section.4.1.p.3">Initial registrations for the SWID/CoSWID Version Schema Values registry are provided below.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Index</th>
<th class="left">Role Name</th>
<th class="left">Specification</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0</td>
<td class="left">Reserved</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">1</td>
<td class="left">multipartnumeric</td>
<td class="left">See <a href="#indexed-version-scheme" class="xref">Section 3.1</a>
</td>
</tr>
<tr>
<td class="left">2</td>
<td class="left">multipartnumeric+suffix</td>
<td class="left">See <a href="#indexed-version-scheme" class="xref">Section 3.1</a>
</td>
</tr>
<tr>
<td class="left">3</td>
<td class="left">alphanumeric</td>
<td class="left">See <a href="#indexed-version-scheme" class="xref">Section 3.1</a>
</td>
</tr>
<tr>
<td class="left">4</td>
<td class="left">decimal</td>
<td class="left">See <a href="#indexed-version-scheme" class="xref">Section 3.1</a>
</td>
</tr>
<tr>
<td class="left">5-16383</td>
<td class="left">Unassigned</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">16384</td>
<td class="left">semver</td>
<td class="left"><a href="#SEMVER" class="xref">[SEMVER]</a></td>
</tr>
<tr>
<td class="left">16385-32767</td>
<td class="left">Unassigned</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">32768-65535</td>
<td class="left">Reserved for Private Use</td>
<td class="left"></td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#iana-entity-role" id="iana-entity-role">SWID/CoSWID Entity Role Values Registry</a>
</h1>
<p id="rfc.section.4.2.p.1">This document uses unsigned 8-bit index values to represent entity-role values. The initial set of Entity roles are derived from the textual role names defined in the ISO/IEC 19770-2:2015 specification <a href="#SWID" class="xref">[SWID]</a>.</p>
<p id="rfc.section.4.2.p.2">This document defines a new a new registry entitled &#8220;SWID/CoSWID Entity Role Values&#8221;. Future registrations for this registry are to be made based on <a href="#RFC8126" class="xref">[RFC8126]</a> as follows:</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Range</th>
<th class="left">Registration Procedures</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0-31</td>
<td class="left">Standards Action</td>
</tr>
<tr>
<td class="left">32-127</td>
<td class="left">Specification Required</td>
</tr>
<tr>
<td class="left">128-255</td>
<td class="left">Reserved for Private Use</td>
</tr>
</tbody>
</table>
<p id="rfc.section.4.2.p.3">Initial registrations for the SWID/CoSWID Entity Role Values registry are provided below.</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Index</th>
<th class="left">Role Name</th>
<th class="left">Specification</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0</td>
<td class="left">Reserved</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">1</td>
<td class="left">tagCreator</td>
<td class="left">See <a href="#indexed-entity-role" class="xref">Section 3.2</a>
</td>
</tr>
<tr>
<td class="left">2</td>
<td class="left">softwareCreator</td>
<td class="left">See <a href="#indexed-entity-role" class="xref">Section 3.2</a>
</td>
</tr>
<tr>
<td class="left">3</td>
<td class="left">aggregator</td>
<td class="left">See <a href="#indexed-entity-role" class="xref">Section 3.2</a>
</td>
</tr>
<tr>
<td class="left">4</td>
<td class="left">distributor</td>
<td class="left">See <a href="#indexed-entity-role" class="xref">Section 3.2</a>
</td>
</tr>
<tr>
<td class="left">5</td>
<td class="left">licensor</td>
<td class="left">See <a href="#indexed-entity-role" class="xref">Section 3.2</a>
</td>
</tr>
<tr>
<td class="left">6-49</td>
<td class="left">Unassigned</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">50-225</td>
<td class="left">Unassigned</td>
<td class="left"></td>
</tr>
<tr>
<td class="left">225-255</td>
<td class="left">Reserved for Private Use</td>
<td class="left"></td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#media-type-registration" id="media-type-registration">Media Type Registration</a>
</h1>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> <a href="#swidcbor-media-type-registration" id="swidcbor-media-type-registration">swid+cbor Media Type Registration</a>
</h1>
<p id="rfc.section.4.3.1.p.1">Type name: application</p>
<p id="rfc.section.4.3.1.p.2">Subtype name: swid+cbor</p>
<p id="rfc.section.4.3.1.p.3">Required parameters: none</p>
<p id="rfc.section.4.3.1.p.4">Optional parameters: none</p>
<p id="rfc.section.4.3.1.p.5">Encoding considerations: Must be encoded as using <a href="#RFC7049" class="xref">[RFC7049]</a>. See RFC-AAAA for details.</p>
<p id="rfc.section.4.3.1.p.6">Security considerations: See <a href="#sec-sec" class="xref">Section 5</a> of RFC-AAAA.</p>
<p id="rfc.section.4.3.1.p.7">Interoperability considerations: Applications MAY ignore any key value pairs that they do not understand. This allows backwards compatible extensions to this specification.</p>
<p id="rfc.section.4.3.1.p.8">Published specification: RFC-AAAA</p>
<p id="rfc.section.4.3.1.p.9">Applications that use this media type: The type is used by Software asset management systems, Vulnerability assessment systems, and in applications that use remote integrity verification.</p>
<p id="rfc.section.4.3.1.p.10">Fragment identifier considerations: Fragment identification for application/swid+cbor is supported by using fragment identifiers as specified by RFC-AAAA. [Section to be defined]</p>
<p id="rfc.section.4.3.1.p.11">Additional information:</p>
<p id="rfc.section.4.3.1.p.12">Magic number(s): first five bytes in hex: da 53 57 49 44</p>
<p id="rfc.section.4.3.1.p.13">File extension(s): coswid</p>
<p id="rfc.section.4.3.1.p.14">Macintosh file type code(s): none</p>
<p id="rfc.section.4.3.1.p.15">Macintosh Universal Type Identifier code: org.ietf.coswid conforms to public.data</p>
<p id="rfc.section.4.3.1.p.16">Person &amp; email address to contact for further information: Henk Birkholz &lt;henk.birkholz@sit.fraunhofer.de&gt;</p>
<p id="rfc.section.4.3.1.p.17">Intended usage: COMMON</p>
<p id="rfc.section.4.3.1.p.18">Restrictions on usage: None</p>
<p id="rfc.section.4.3.1.p.19">Author: Henk Birkholz &lt;henk.birkholz@sit.fraunhofer.de&gt;</p>
<p id="rfc.section.4.3.1.p.20">Change controller: IESG</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#coap-content-format-registration" id="coap-content-format-registration">CoAP Content-Format Registration</a>
</h1>
<p id="rfc.section.4.4.p.1">IANA is requested to assign a CoAP Content-Format ID for the CoSWID media type in the &#8220;CoAP Content-Formats&#8221; sub-registry, from the &#8220;IETF Review or IESG Approval&#8221; space (256..999), within the &#8220;CoRE Parameters&#8221; registry <a href="#RFC7252" class="xref">[RFC7252]</a>:</p>
<div id="rfc.table.1"></div>
<div id="tbl-coap-content-formats"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>CoAP Content-Format IDs</caption>
<thead><tr>
<th class="left">Media type</th>
<th class="left">Encoding</th>
<th class="left">ID</th>
<th class="left">Reference</th>
</tr></thead>
<tbody><tr>
<td class="left">application/swid+cbor</td>
<td class="left">-</td>
<td class="left">TBDcf</td>
<td class="left">RFC-AAAA</td>
</tr></tbody>
</table>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#cbor-tag-registration" id="cbor-tag-registration">CBOR Tag Registration</a>
</h1>
<p id="rfc.section.4.5.p.1">IANA is requested to allocate a tag in the CBOR Tags Registry, preferably with the specific value requested:</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Tag</th>
<th class="left">Data Item</th>
<th class="left">Semantics</th>
</tr></thead>
<tbody><tr>
<td class="left">1398229316</td>
<td class="left">map</td>
<td class="left">Concise Software Identifier (CoSWID) [RFC-AAAA]</td>
</tr></tbody>
</table>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#sec-sec" id="sec-sec">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">SWID and CoSWID tags contain public information about software components and, as such, do not need to be protected against disclosure on an endpoint.  Similarly, SWID tags are intended to be easily discoverable by applications and users on an endpoint in order to make it easy to identify and collect all of an endpoint&#8217;s SWID tags.  As such, any security considerations regarding SWID tags focus on the application of SWID tags to address security challenges, and the possible disclosure of the results of those applications.</p>
<p id="rfc.section.5.p.2">A signed SWID tag whose signature has been validated can be relied upon to be unchanged since it was signed.  If the SWID tag was created by the software provider, is signed, and the software provider can be authenticated as the originator of the signature, then the tag can be considered authoritative.  In this way, an authoritative SWID tag contains information about a software product provided by the maintainer of the product, who is expected to be an expert in their own product. Thus, authoritative SWID tags can be trusted to represent authoritative information about the software product.  Having an authoritative SWID tag can be useful when the information in the tag needs to be trusted, such as when the tag is being used to convey reference integrity measurements for software components.  By contrast, the data contained in unsigned tags cannot be trusted to be unmodified.</p>
<p id="rfc.section.5.p.3">SWID tags are designed to be easily added and removed from an endpoint along with the installation or removal of software components.  On endpoints where addition or removal of software components is tightly controlled, the addition or removal of SWID tags can be similarly controlled.  On more open systems, where many users can manage the software inventory, SWID tags may be easier to add or remove.  On such systems, it may be possible to add or remove SWID tags in a way that does not reflect the actual presence or absence of corresponding software components.  Similarly, not all software products automatically install SWID tags, so products may be present on an endpoint without providing a corresponding SWID tag.  As such, any collection of SWID tags cannot automatically be assumed to represent either a complete or fully accurate representation of the software inventory of the endpoint.  However, especially on devices that more strictly control the ability to add or remove applications, SWID tags are an easy way to provide an preliminary understanding of that endpoint&#8217;s software inventory.</p>
<p id="rfc.section.5.p.4">Any report of an endpoint&#8217;s SWID tag collection provides information about the software inventory of that endpoint.  If such a report is exposed to an attacker, this can tell them which software products and versions thereof are present on the endpoint.  By examining this list, the attacker might learn of the presence of applications that are vulnerable to certain types of attacks.  As noted earlier, SWID tags are designed to be easily discoverable by an endpoint, but this does not present a significant risk since an attacker would already need to have access to the endpoint to view that information.  However, when the endpoint transmits its software inventory to another party, or that inventory is stored on a server for later analysis, this can potentially expose this information to attackers who do not yet have access to the endpoint.  As such, it is important to protect the confidentiality of SWID tag information that has been collected from an endpoint, not because those tags individually contain sensitive information, but because the collection of SWID tags and their association with an endpoint reveals information about that endpoint&#8217;s attack surface.</p>
<p id="rfc.section.5.p.5">Finally, both the ISO-19770-2:2015 XML schema definition and the Concise SWID data definition allow for the construction of &#8220;infinite&#8221; SWID tags or SWID tags that contain malicious content with the intent if creating non-deterministic states during validation or processing of SWID tags. While software product vendors are unlikely to do this, SWID tags can be created by any party and the SWID tags collected from an endpoint could contain a mixture of vendor and non-vendor created tags. For this reason, tools that consume SWID tags ought to treat the tag contents as potentially malicious and should employ input sanitizing on the tags they ingest.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a>
</h1>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#change-log" id="change-log">Change Log</a>
</h1>
<p id="rfc.section.7.p.1">Changes from version 05 to version 06:</p>
<p></p>

<ul>
<li>Improved quantities</li>
<li>Included proposals for implicet enumerations that were NMTOKENS</li>
<li>Added extension points</li>
<li>Improved exemplary firmware-resource extension</li>
</ul>
<p id="rfc.section.7.p.3">Changes from version 04 to version 05:</p>
<p></p>

<ul>
<li>Clarified language around SWID and CoSWID to make more consistant use of these terms.</li>
<li>Added language describing CBOR optimizations for single vs. arrays in the model front matter.</li>
<li>Fixed a number of gramatical, spelling, and wording issues.</li>
<li>Documented extension points that use CDDL sockets.</li>
<li>Converted IANA registration tables to markdown tables, reserving the 0 value for use when a value is not known.</li>
<li>Updated a number of references to their current versions.</li>
</ul>
<p id="rfc.section.7.p.5">Changes from version 03 to version 04:</p>
<p></p>

<ul>
<li>Re-index label values in the CDDL.</li>
<li>Added a section describing the CoSWID model in detail.</li>
<li>Created IANA registries for entity-role and version-scheme</li>
</ul>
<p id="rfc.section.7.p.7">Changes from version 02 to version 03:</p>
<p></p>

<ul>
<li>Updated CDDL to allow for a choice between a payload or evidence</li>
<li>Re-index label values in the CDDL.</li>
<li>Added item definitions</li>
<li>Updated references for COSE, CBOR Web Token, and CDDL.</li>
</ul>
<p id="rfc.section.7.p.9">Changes from version 01 to version 02:</p>
<p></p>

<ul>
<li>Added extensions for Firmware and CoSWID use as Reference Integrity Measurements (CoSWID RIM)</li>
<li>Changes meta handling in CDDL from use of an explicit use of items to a more flexible unconstrained collection of items.</li>
<li>Added sections discussing use of COSE Signatures and CBOR Web Tokens</li>
</ul>
<p id="rfc.section.7.p.11">Changes from version 00 to version 01:</p>
<p></p>

<ul>
<li>Added CWT usage for absolute SWID paths on a device</li>
<li>Fixed cardinality of type-choices including arrays</li>
<li>Included first iteration of firmware resource-collection</li>
</ul>
<p id="rfc.section.7.p.13">Changes since adopted as a WG I-D -00:</p>
<p></p>

<ul>
<li>Removed redundant any-attributes originating from the ISO-19770-2:2015 XML schema definition</li>
<li>Fixed broken multi-map members</li>
<li>Introduced a more restrictive item (any-element-map) to represent custom maps, increased restriction on types for the any-attribute, accordingly</li>
<li>Fixed X.1520 reference</li>
<li>Minor type changes of some attributes (e.g. NMTOKENS)</li>
<li>Added semantic differentiation of various name types (e,g. fs-name)</li>
</ul>
<p id="rfc.section.7.p.15">Changes from version 00 to version 01:</p>
<p></p>

<ul>
<li>Ambiguity between evidence and payload eliminated by introducing explicit members (while still</li>
<li>allowing for &#8220;empty&#8221; SWID tags)</li>
<li>Added a relatively restrictive COSE envelope using cose_sign1 to define signed CoSWID (single signer only, at the moment)</li>
<li>Added a definition how to encode hashes that can be stored in the any-member using existing IANA tables to reference hash-algorithms</li>
</ul>
<p id="rfc.section.7.p.17">Changes from version 01 to version 02:</p>
<p></p>

<ul>
<li>Enforced a more strict separation between the core CoSWID definition and additional usage by moving content to corresponding appendices.</li>
<li>Removed artifacts inherited from the reference schema provided by ISO (e.g. NMTOKEN(S))</li>
<li>Simplified the core data definition by removing group and type choices where possible</li>
<li>Minor reordering of map members</li>
<li>Added a first extension point to address requested flexibility for extensions beyond the any-element</li>
</ul>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#contributors" id="contributors">Contributors</a>
</h1>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-ace-cbor-web-token">[I-D.ietf-ace-cbor-web-token]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Wahlstroem, E.</a>, <a>Erdtman, S.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/draft-ietf-ace-cbor-web-token-15">CBOR Web Token (CWT)</a>", Internet-Draft draft-ietf-ace-cbor-web-token-15, March 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4108">[RFC4108]</b></td>
<td class="top">
<a>Housley, R.</a>, "<a href="https://tools.ietf.org/html/rfc4108">Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages</a>", RFC 4108, DOI 10.17487/RFC4108, August 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5646">[RFC5646]</b></td>
<td class="top">
<a>Phillips, A.</a> and <a>M. Davis</a>, "<a href="https://tools.ietf.org/html/rfc5646">Tags for Identifying Languages</a>", BCP 47, RFC 5646, DOI 10.17487/RFC5646, September 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7049">[RFC7049]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7252">[RFC7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8126">[RFC8126]</b></td>
<td class="top">
<a>Cotton, M.</a>, <a>Leiba, B.</a> and <a>T. Narten</a>, "<a href="https://tools.ietf.org/html/rfc8126">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 8126, DOI 10.17487/RFC8126, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8152">[RFC8152]</b></td>
<td class="top">
<a>Schaad, J.</a>, "<a href="https://tools.ietf.org/html/rfc8152">CBOR Object Signing and Encryption (COSE)</a>", RFC 8152, DOI 10.17487/RFC8152, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="SAM">[SAM]</b></td>
<td class="top">"<a>Information technology - Software asset management - Part 5: Overview and vocabulary</a>", ISO/IEC 19770-5:2013, November 2013.</td>
</tr>
<tr>
<td class="reference"><b id="SEMVER">[SEMVER]</b></td>
<td class="top">
<a>Preston-Werner, T.</a>, "<a href="https://semver.org/spec/v2.0.0.html">Semantic Versioning 2.0.0</a>", n.d..</td>
</tr>
<tr>
<td class="reference"><b id="SWID">[SWID]</b></td>
<td class="top">"<a>Information technology - Software asset management - Part 2: Software identification tag</a>", ISO/IEC 19770-2:2015, October 2015.</td>
</tr>
<tr>
<td class="reference"><b id="SWID-GUIDANCE">[SWID-GUIDANCE]</b></td>
<td class="top">
<a title="National Institute for Standards and Technology">Waltermire, D.</a>, <a title="The MITRE Corporation">Cheikes, B.</a>, <a title="G2, Inc">Feldman, L.</a> and <a title="G2, Inc">G. Witte</a>, "<a href="https://doi.org/10.6028/NIST.IR.8060">Guidelines for the Creation of Interoperable Software Identification (SWID) Tags</a>", NISTIR 8060, April 2016.</td>
</tr>
<tr>
<td class="reference"><b id="X.1520">[X.1520]</b></td>
<td class="top">"<a>Recommendation ITU-T X.1520 (2014), Common vulnerabilities and exposures</a>", April 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.birkholz-tuda">[I-D.birkholz-tuda]</b></td>
<td class="top">
<a>Fuchs, A.</a>, <a>Birkholz, H.</a>, <a>McDonald, I.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/draft-birkholz-tuda-04">Time-Based Uni-Directional Attestation</a>", Internet-Draft draft-birkholz-tuda-04, March 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-cbor-cddl">[I-D.ietf-cbor-cddl]</b></td>
<td class="top">
<a>Birkholz, H.</a>, <a>Vigano, C.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/draft-ietf-cbor-cddl-05">Concise data definition language (CDDL): a notational convention to express CBOR and JSON data structures</a>", Internet-Draft draft-ietf-cbor-cddl-05, August 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-sacm-rolie-softwaredescriptor">[I-D.ietf-sacm-rolie-softwaredescriptor]</b></td>
<td class="top">
<a>Banghart, S.</a> and <a>D. Waltermire</a>, "<a href="https://tools.ietf.org/html/draft-ietf-sacm-rolie-softwaredescriptor-03">Definition of the ROLIE Software Descriptor Extension</a>", Internet-Draft draft-ietf-sacm-rolie-softwaredescriptor-03, July 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-sacm-terminology">[I-D.ietf-sacm-terminology]</b></td>
<td class="top">
<a>Birkholz, H.</a>, <a>Lu, J.</a>, <a>Strassner, J.</a>, <a>Cam-Winget, N.</a> and <a>A. Montville</a>, "<a href="https://tools.ietf.org/html/draft-ietf-sacm-terminology-15">Security Automation and Continuous Monitoring (SACM) Terminology</a>", Internet-Draft draft-ietf-sacm-terminology-15, June 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4122">[RFC4122]</b></td>
<td class="top">
<a>Leach, P.</a>, <a>Mealling, M.</a> and <a>R. Salz</a>, "<a href="https://tools.ietf.org/html/rfc4122">A Universally Unique IDentifier (UUID) URN Namespace</a>", RFC 4122, DOI 10.17487/RFC4122, July 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4949">[RFC4949]</b></td>
<td class="top">
<a>Shirey, R.</a>, "<a href="https://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>", FYI 36, RFC 4949, DOI 10.17487/RFC4949, August 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7228">[RFC7228]</b></td>
<td class="top">
<a>Bormann, C.</a>, <a>Ersue, M.</a> and <a>A. Keranen</a>, "<a href="https://tools.ietf.org/html/rfc7228">Terminology for Constrained-Node Networks</a>", RFC 7228, DOI 10.17487/RFC7228, May 2014.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#coswid-attributes-for-firmware-label-60" id="coswid-attributes-for-firmware-label-60">CoSWID Attributes for Firmware (label 60)</a>
</h1>
<p id="rfc.section.A.p.1">The ISO-19770-2:2015 specification of SWID tags assumes the existence of a file system a software component is installed and stored in. In the case of constrained-node networks <a href="#RFC7228" class="xref">[RFC7228]</a> or network equipment this assumption might not apply. Concise software instances in the form of (modular) firmware are often stored directly on a block device that is a hardware component of the constrained-node or network equipment. Multiple differentiable block devices or segmented block devices that contain parts of modular firmware components (potentially each with their own instance version) are already common at the time of this writing.</p>
<p id="rfc.section.A.p.2">The optional attributes that annotate a firmware package address specific characteristics of pieces of firmware stored directly on a block-device in contrast to software deployed in a file-system.  In essence, trees of relative path-elements expressed by the directory and file structure in CoSWID tags are typically unable to represent the location of a firmware on a constrained-node (small thing). The composite nature of firmware and also the actual composition of small things require a set of attributes to address the identification of the correct component in a composite thing for each individual piece of firmware. A single component also potentially requires a number of distinct firmware parts that might depend on each other (versions). These dependencies can be limited to the scope of the component itself or extend to the scope of a larger composite device. In addition, it might not be possible (or feasible) to store a CoSWID tag document (permanently) on a small thing along with the corresponding piece of firmware.</p>
<p id="rfc.section.A.p.3">To address the specific characteristics of firmware, the extension points <samp>$$payload-extension</samp> and <samp>$$evidence-extension</samp> are used to allow for an additional type of resource description&#8212;firmware-entry&#8212;thereby increasing the self-descriptiveness and flexibility of CoSWID. The optional use of the extension points <samp>$$payload-extension</samp> and <samp>$$evidence-extension</samp> in respect to firmware MUST adhere to the following CDDL data definition.</p>
<pre>
&lt;CODE BEGINS&gt;
$$payload-extension  //= (suit.manifest-entry,)
$$evidence-extension  //= (suit.manifest-entry,)

suit-manifest = {
  suit.manifest-version,
  suit.digest-info,
  suit.text-reference,
  suit.nonce,
  suit.sequence-number,
  ? suit.pre-condition,
  ? suit.post-condition,
  ? suit.directives,
  ? suit.resources,
  ? suit.processors,
  ? suit.targets,
  ? suit.extensions,
}

suit.manifest-entry = (59: suit-manifest / [ 2* suit-manifest ] )
suit.manifest-version = (60: 1)
suit.digest-info = (61: [ suit.digest-algorithm,
                          ? suit.digest-parameters,
                        ]
                   )
suit.digest-algorithm = uint
suit.digest-parameters = bytes
suit.text-reference = (62: bytes)
suit.nonce = (63: bytes)
suit.sequence-number = (64: uint)
suit.pre-condition = (suit.id-condition // suit.time-condition // suit.image-condition // suit.custom-condition)
suit.post-condition = (suit.image-condition // suit.custom-condition)
suit.id-condition = (65: [ + [ suit.vendor / suit.class / suit.device,
                               suit.uuid,
                             ]
                         ]
                    ) 
suit.vendor = 0
suit.class = 1
suit.device = 2
suit.uuid = bstr .size 16
suit.time-condition = (66: [ + [ suit.install-after / suit.best-before,
                                 suit.timestamp,
                               ]
                           ]
                      )
suit.install-after = 0
suit.best-before = 1
suit.timestamp = uint .size 8
suit.image-condition = (67: [ + [ suit.current-content / suit.not-current-content,
                                  suit.storage-identifier,
                                  ? suit.digest,
                                ]
                            ]
                       )
suit.current-content = 0
suit.not-current-content = 1
suit.digest = bytes
suit.storage-identifier = bytes
suit.custom-condition = (68: [ nint,
                               suit.condition-parameters,
                             ]
                        )
suit.condition-parameters = bytes
suit.directives = (69: { + int =&gt; bytes } )
suit.resources = (70: [ + [ suit.resource-type,
                            suit.uri-list,
                            suit.digest,
                            suit.onode,
                            ? suit.size,
                          ]
                      ] 
                 )
suit.resource-type = suit.payload / suit.dependency / suit.key / suit.alias
suit.payload = 0
suit.dependency = 1
suit.key = 2
suit.alias = 3
suit.uri-list = { + int =&gt; text }
suit.size = uint
suit.onode = bytes
suit.processors = (71: [ + [ suit.decrypt / suit.decompress / suit.undiff / suit.relocate / suit.unrelocate,
                             suit.parameters,
                             suit.inode,
                             suit.onode,
                           ]
                       ]
                  )
suit.decrypt = 0
suit.decompress = 1
suit.undiff = 2
suit.relocate = 3
suit.unrelocate = 4
suit.parameters = bytes
suit.inode = bytes
suit.targets = (72: [ + [ suit.component-id,
                          suit.storage-identifier,
                          suit.inode,
                          ? suit.encoding,
                        ]
                    ]
                )
suit.component-id = [ + bytes ]
suit.encoding = bytes
suit.extensions = (73: { + int =&gt; bytes } )
&lt;CODE ENDS&gt;
</pre>
<p id="rfc.section.A.p.4">The members of the firmware group that constitutes the content of the firmware-entry is based on the metadata about firmware Described in <a href="#RFC4108" class="xref">[RFC4108]</a>. As with every semantic differentiation that is supported by the resource-collection type, the use of firmware-entry is optional. It is REQUIRED not to instantiate more than one firmware-entry, as the firmware group is used in a map and therefore only allows for unique labels.</p>
<p id="rfc.section.A.p.5">The optional cms-firmware-package member allows to include the actual firmware in the CoSWID tag that also expresses its metadata as a byte-string. This option enables a CoSWID tag to be used as a container or wrapper that composes both firmware and its metadata in a single document (which again can be signed, encrypted and/or compressed). In consequence, a CoSWID tag about firmware can be conveyed as an identifying document across endpoints or used as a reference integrity measurement as usual. Alternatively, it can also convey an actual piece of firmware, serve its intended purpose as a SWID tag and then - due to the lack of a location to store it - be discarded.</p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#signed-concise-swid-tags-using-cose" id="signed-concise-swid-tags-using-cose">Signed Concise SWID Tags using COSE</a>
</h1>
<p id="rfc.section.B.p.1">SWID tags, as defined in the ISO-19770-2:2015 XML schema, can include cryptographic signatures to protect the integrity of the SWID tag. In general, tags are signed by the tag creator (typically, although not exclusively, the vendor of the software component that the SWID tag identifies).  Cryptographic signatures can make any modification of the tag detectable, which is especially important if the integrity of the tag is important, such as when the tag is providing reference integrity measurements for files.</p>
<p id="rfc.section.B.p.2">The ISO-19770-2:2015 XML schema uses XML DSIG to support cryptographic signatures. CoSWID tags require a different signature scheme than this. COSE (CBOR Object Signing and Encryption) provides the required mechanism <a href="#RFC8152" class="xref">[RFC8152]</a>. Concise SWID can be wrapped in a COSE Single Signer Data Object (cose-sign1) that contains a single signature. The following CDDL defines a more restrictive subset of header attributes allowed by COSE tailored to suit the requirements of Concise SWID.</p>
<pre>
&lt;CODE BEGINS&gt;
signed-coswid = #6.997(COSE-Sign1-coswid) ; see TBS7 in current COSE I-D

label = int / tstr  ; see COSE I-D 1.4.
values = any        ; see COSE I-D 1.4.

unprotected-signed-coswid-header = {
    1 =&gt; int,                   ; algorithm identifier
    3 =&gt; "application/coswid",  ; request for CoAP IANA registry to become an int
    * label =&gt; values,
}

protected-signed-coswid-header = {
    4 =&gt; bstr,                  ; key identifier
    * label =&gt; values,
}

COSE-Sign1-coswid = [
    protected: bstr .cbor protected-signed-coswid-header,
    unprotected: unprotected-signed-coswid-header,
    payload: bstr .cbor concise-software-identity,
    signature: bstr,
]
&lt;CODE ENDS&gt;
</pre>
<h1 id="rfc.appendix.C">
<a href="#rfc.appendix.C">Appendix C.</a> <a href="#coswid-used-as-reference-integrity-measurements-coswid-rim" id="coswid-used-as-reference-integrity-measurements-coswid-rim">CoSWID used as Reference Integrity Measurements (CoSWID RIM)</a>
</h1>
<p id="rfc.section.C.p.1">A vendor supplied signed CoSWID tag that includes hash-values for the files that compose a software component can be used as a RIM (reference integrity measurement). A RIM is a type of declarative guidance that can be used to assert the compliance of an endpoint by assessing the installed software. In the context of remote attestation based on an attestation via hardware rooted trust, a verifier can appraise the integrity of the conveyed measurements of software components using a CoSWID RIM provided by a source, such as <a href="#I-D.ietf-sacm-rolie-softwaredescriptor" class="xref">[I-D.ietf-sacm-rolie-softwaredescriptor]</a>.</p>
<p></p>

<dl>
<dt>RIM Manifests (RIMM):</dt>
<dd style="margin-left: 8">A group of SWID tags about the same (sub-)system, system entity, or (sub-)component (compare <a href="#RFC4949" class="xref">[RFC4949]</a>). A RIMM manifest is a distinct document that is typically conveyed en-block and constitutes declarative guidance in respect to a specific (target) endpoint (compare <a href="#I-D.ietf-sacm-terminology" class="xref">[I-D.ietf-sacm-terminology]</a>).</dd>
</dl>
<p id="rfc.section.C.p.3">If multiple CoSWID compose a RIMM, the following CDDL data definition SHOULD be used.</p>
<pre>
RIMM = [ + concise-software-identity / signed-coswid ]
</pre>
<h1 id="rfc.appendix.D">
<a href="#rfc.appendix.D">Appendix D.</a> <a href="#cbor-web-token-for-concise-swid-tags" id="cbor-web-token-for-concise-swid-tags">CBOR Web Token for Concise SWID Tags</a>
</h1>
<p id="rfc.section.D.p.1">A typical requirement regarding specific instantiations of endpoints &#8211; and, as a result, specific instantiations of software components - is a representation of the absolute path of a CoSWID tag document in a file system in order to derive absolute paths of files represented in the corresponding CoSWID tag. The absolute path of an evidence CoSWID tag can be included as a claim in the header of a CBOR Web Token <a href="#I-D.ietf-ace-cbor-web-token" class="xref">[I-D.ietf-ace-cbor-web-token]</a>. Depending on the source of the token, the claim can be in the protected or unprotected header portion.</p>
<pre>
&lt;CODE BEGINS&gt;
 CDDL TBD
&lt;CODE ENDS&gt;
</pre>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Henk Birkholz</span> 
	  <span class="n hidden">
		<span class="family-name">Birkholz</span>
	  </span>
	</span>
	<span class="org vcardline">Fraunhofer SIT</span>
	<span class="adr">
	  <span class="vcardline">Rheinstrasse 75</span>

	  <span class="vcardline">
		<span class="locality">Darmstadt</span>,  
		<span class="region"></span>
		<span class="code">64295</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:henk.birkholz@sit.fraunhofer.de">henk.birkholz@sit.fraunhofer.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jessica Fitzgerald-McKay</span> 
	  <span class="n hidden">
		<span class="family-name">Fitzgerald-McKay</span>
	  </span>
	</span>
	<span class="org vcardline">Department of Defense</span>
	<span class="adr">
	  <span class="vcardline">9800 Savage Road</span>

	  <span class="vcardline">
		<span class="locality">Ft. Meade</span>,  
		<span class="region">Maryland</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jmfitz2@nsa.gov">jmfitz2@nsa.gov</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Charles Schmidt</span> 
	  <span class="n hidden">
		<span class="family-name">Schmidt</span>
	  </span>
	</span>
	<span class="org vcardline">The MITRE Corporation</span>
	<span class="adr">
	  <span class="vcardline">202 Burlington Road</span>

	  <span class="vcardline">
		<span class="locality">Bedford</span>,  
		<span class="region">Maryland</span> 
		<span class="code">01730</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:cmschmidt@mitre.org">cmschmidt@mitre.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">David Waltermire</span> 
	  <span class="n hidden">
		<span class="family-name">Waltermire</span>
	  </span>
	</span>
	<span class="org vcardline">National Institute of Standards and Technology</span>
	<span class="adr">
	  <span class="vcardline">100 Bureau Drive</span>

	  <span class="vcardline">
		<span class="locality">Gaithersburg</span>,  
		<span class="region">Maryland</span> 
		<span class="code">20877</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:david.waltermire@nist.gov">david.waltermire@nist.gov</a></span>

  </address>
</div>

</body>
</html>
